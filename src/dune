(rule
 (targets liblab_tools.a)
 (deps (glob_files_rec *.rs))
 (action
  (progn
   (run cargo build --manifest-path %{project_root}/../../lib/Cargo.toml --release)
   (run mv %{project_root}/../../lib/target/release/liblab_tools.a liblab_tools.a))))

(executable
 (name Main)
 (public_name lab-tools)
 (modules Main Roster Common Record Xlsx Pdf Monad)
 (preprocess (pps ppx_blob))
 (preprocessor_deps
   (file %{project_root}/fonts/Carlito-Regular.otf)
   (file %{project_root}/fonts/Carlito-Bold.otf))
 (libraries bos containers cmdliner csv gg otoml str vg vg.pdf)
 (foreign_archives lab_tools))
